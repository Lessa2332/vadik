<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAR –ì—Ä–∞</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
            background: #000;
        }
       
        .controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            text-align: center;
            z-index: 1000;
        }
       
        .game-info {
            position: absolute;
            top: 10px;
            left: 0;
            right: 0;
            text-align: center;
            color: white;
            z-index: 1000;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-bottom: 2px solid #4CAF50;
        }
       
        .button {
            background: linear-gradient(45deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            min-width: 150px;
        }
       
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }
       
        .button:active {
            transform: translateY(1px);
        }
       
        .stop-btn {
            background: linear-gradient(45deg, #f44336, #c62828);
        }
       
        .counter {
            font-size: 24px;
            color: #4CAF50;
            font-weight: bold;
            margin-left: 10px;
        }
       
        .result {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            z-index: 2000;
            display: none;
            border: 3px solid #4CAF50;
        }
       
        .result h2 {
            color: #4CAF50;
            margin-bottom: 20px;
        }
       
        .result-mask {
            font-size: 48px;
            margin: 20px 0;
        }
       
        .close-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
        }
       
        .current-mask {
            color: #FF9800;
            font-weight: bold;
        }
       
        .slot-machine {
            position: absolute;
            top: 70px;
            left: 0;
            right: 0;
            text-align: center;
            color: white;
            z-index: 1000;
        }
       
        .slot {
            display: inline-block;
            width: 100px;
            height: 100px;
            margin: 0 10px;
            border: 3px solid #4CAF50;
            border-radius: 10px;
            overflow: hidden;
            background: rgba(255,255,255,0.1);
        }
       
        .slot img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
    </style>
</head>
<body>
    <div class="game-info">
        <h2>üé≠ AR –ì—Ä–∞ üé≠</h2>
        <p>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å START –¥–ª—è –∑–∞–ø—É—Å–∫—É –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –≤–∏–±–æ—Ä—É!</p>
    </div>
   
    <div class="slot-machine" id="slotMachine">
        <div class="slot">
            <img id="slot1" src="" alt="–ú–∞—Å–∫–∞ 1">
        </div>
        <div class="slot">
            <img id="slot2" src="" alt="–ú–∞—Å–∫–∞ 2">
        </div>
        <div class="slot">
            <img id="slot3" src="" alt="–ú–∞—Å–∫–∞ 3">
        </div>
    </div>
   
    <div class="controls">
        <button class="button" id="startBtn" onclick="startGame()">
            ‚ñ∂Ô∏è START –ì–†–ò
        </button>
        <button class="button stop-btn" id="stopBtn" onclick="stopGame()" disabled>
            ‚èπÔ∏è STOP
        </button>
        <span class="counter">
            <span id="currentTime">0.0</span>—Å
        </span>
    </div>
   
    <div class="result" id="resultPanel">
        <h2>üéâ –°—É–ø–µ—Ä! üéâ</h2>
        <div class="result-mask" id="resultMask">üé≠</div>
        <p>–í—ñ—Ç–∞—é!</p>
        <button class="close-btn" onclick="closeResult()">–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –≥—Ä—É</button>
    </div>
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;" renderer="logarithmicDepthBuffer: true;">
        <!-- –ú–∞—Ä–∫–µ—Ä –¥–ª—è —Ç—Ä–µ–∫—ñ–Ω–≥—É –æ–±–ª–∏—á—á—è -->
        <a-marker type="face" raycaster="objects: .clickable" emitevents="true"
                  cursor="fuse: false; rayOrigin: mouse;"
                  id="face-marker">
           
            <!-- –ú–∞—Å–∫–∞ (–¥–∏–Ω–∞–º—ñ—á–Ω–æ –∑–º—ñ–Ω—é—î—Ç—å—Å—è) -->
            <a-entity id="mask-entity"
                     position="0 0.15 0.05"
                     scale="0.2 0.2 0.2"
                     geometry="primitive: plane"
                     material="src: #mask1; transparent: true; opacity: 1.0"
                     rotation="0 0 0">
            </a-entity>
           
        </a-marker>
       
        <!-- –ö–∞–º–µ—Ä–∞ -->
        <a-entity camera></a-entity>
       
        <!-- –¢–µ–∫—Å—Ç—É—Ä–∏ –¥–ª—è –º–∞—Å–æ–∫ -->
        <a-assets>
            <img id="mask1" src="masks/mask1.png">
            <img id="mask2" src="masks/mask2.png">
            <img id="mask3" src="masks/mask3.png">
            <img id="mask4" src="masks/mask4.png">
            <img id="mask5" src="masks/mask5.png">
        </a-assets>
       
        <!-- –î–æ–¥–∞—Ç–∫–æ–≤–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è (–æ–ø—Ü—ñ–π–Ω–æ) -->
        <a-entity id="effects" position="0 0.3 0">
            <a-circle id="glowEffect" radius="0.3" color="#4CAF50" opacity="0.3"
                     position="0 0 -0.1" visible="false"></a-circle>
        </a-entity>
    </a-scene>
   
    <script>
        // –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –≥—Ä–∏
        const config = {
            masks: ['mask1', 'mask2', 'mask3', 'mask4', 'mask5'],
            slotCount: 3, // –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ª–æ—Ç—ñ–≤
            spinSpeed: 100, // –®–≤–∏–¥–∫—ñ—Å—Ç—å –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ (–º—Å)
            spinDuration: 2000, // –ë–∞–∑–æ–≤–∞ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Å–ø—ñ–Ω—É (–º—Å)
            maxSpins: 20 // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–±–µ—Ä—Ç—ñ–≤
        };
       
        // –ó–º—ñ–Ω–Ω—ñ –≥—Ä–∏
        let gameState = {
            isSpinning: false,
            currentMask: 'mask1',
            spinInterval: null,
            spinStartTime: 0,
            spins: 0,
            finalMask: null
        };
       
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞–π–º–µ—Ä–∞
        function updateTimer() {
            if (gameState.isSpinning) {
                const elapsed = (Date.now() - gameState.spinStartTime) / 1000;
                document.getElementById('currentTime').textContent = elapsed.toFixed(1);
                requestAnimationFrame(updateTimer);
            }
        }
       
        // –ó–∞–ø—É—Å–∫ –≥—Ä–∏
        function startGame() {
            if (gameState.isSpinning) return;
           
            gameState.isSpinning = true;
            gameState.spinStartTime = Date.now();
            gameState.spins = 0;
            gameState.finalMask = null;
           
            // –ê–∫—Ç–∏–≤—É—î–º–æ –∫–Ω–æ–ø–∫–∏
            document.getElementById('startBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;
           
            // –ó–∞–ø—É—Å–∫–∞—î–º–æ —Ç–∞–π–º–µ—Ä
            updateTimer();
           
            // –ó–∞–ø—É—Å–∫–∞—î–º–æ –∞–Ω—ñ–º–∞—Ü—ñ—é —Å–ª–æ—Ç—ñ–≤
            startSlotAnimation();
           
            // –ó–∞–ø—É—Å–∫–∞—î–º–æ –∑–º—ñ–Ω—É –º–∞—Å–æ–∫
            gameState.spinInterval = setInterval(changeMask, config.spinSpeed);
           
            // –ê–Ω—ñ–º–∞—Ü—ñ—è –µ—Ñ–µ–∫—Ç—ñ–≤
            document.getElementById('glowEffect').setAttribute('visible', 'true');
           
            console.log('–ì—Ä–∞ —Ä–æ–∑–ø–æ—á–∞—Ç–∞!');
        }
       
        // –ó—É–ø–∏–Ω–∫–∞ –≥—Ä–∏
        function stopGame() {
            if (!gameState.isSpinning) return;
           
            gameState.isSpinning = false;
            clearInterval(gameState.spinInterval);
           
            // –í–∏–ø–∞–¥–∫–æ–≤–æ –æ–±–∏—Ä–∞—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω—É –º–∞—Å–∫—É
            const randomMask = config.masks[Math.floor(Math.random() * config.masks.length)];
            gameState.finalMask = randomMask;
           
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω—É –º–∞—Å–∫—É
            setMask(randomMask);
           
            // –ó—É–ø–∏–Ω—è—î–º–æ —Å–ª–æ—Ç–∏
            stopSlotAnimation(randomMask);
           
            // –î–µ–∞–∫—Ç–∏–≤—É—î–º–æ –∫–Ω–æ–ø–∫–∏
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
           
            // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            showResult(randomMask);
           
            // –í–∏–º–∏–∫–∞—î–º–æ –µ—Ñ–µ–∫—Ç–∏
            document.getElementById('glowEffect').setAttribute('visible', 'false');
           
            console.log('–ì—Ä–∞ –∑—É–ø–∏–Ω–µ–Ω–∞. –í–∏–±—Ä–∞–Ω–∞ –º–∞—Å–∫–∞:', randomMask);
        }
       
        // –ó–º—ñ–Ω–∞ –º–∞—Å–∫–∏
        function changeMask() {
            if (!gameState.isSpinning) return;
           
            // –í–∏–ø–∞–¥–∫–æ–≤–æ –æ–±–∏—Ä–∞—î–º–æ –º–∞—Å–∫—É
            const randomMask = config.masks[Math.floor(Math.random() * config.masks.length)];
            gameState.currentMask = randomMask;
           
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –º–∞—Å–∫—É
            setMask(randomMask);
           
            // –û–Ω–æ–≤–ª—é—î–º–æ —Å–ª–æ—Ç–∏
            updateSlots(randomMask);
           
            gameState.spins++;
           
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∑—É–ø–∏–Ω–∫–∞ –ø—ñ—Å–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å–ø—ñ–Ω—ñ–≤
            if (gameState.spins >= config.maxSpins) {
                stopGame();
            }
        }
       
        // –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –º–∞—Å–∫–∏ –Ω–∞ –æ–±–ª–∏—á—á—è
        function setMask(maskId) {
            const maskEntity = document.getElementById('mask-entity');
            maskEntity.setAttribute('material', 'src', '#' + maskId);
        }
       
        // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
        function showResult(maskId) {
            const resultPanel = document.getElementById('resultPanel');
            const resultMask = document.getElementById('resultMask');
           
            // –¢–µ–∫—Å—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
            const maskNames = {
                'mask1': 'üî• –í–û–ì–ù–Ø–ù–ê –ú–ê–°–ö–ê üî•',
                'mask2': '‚ùÑÔ∏è –ö–†–ò–ñ–ê–ù–ê –ú–ê–°–ö–ê ‚ùÑÔ∏è',
                'mask3': 'üåø –õ–Ü–°–û–í–ê –ú–ê–°–ö–ê üåø',
                'mask4': '‚≠ê –ó–Ü–†–ö–û–í–ê –ú–ê–°–ö–ê ‚≠ê',
                'mask5': 'üåô –ú–Ü–°–Ø–ß–ù–ê –ú–ê–°–ö–ê üåô'
            };
           
            resultMask.textContent = maskNames[maskId] || 'üé≠ –¢–ê–Ñ–ú–ù–ò–ß–ê –ú–ê–°–ö–ê üé≠';
            resultPanel.style.display = 'block';
           
            // –ê–Ω—ñ–º–∞—Ü—ñ—è
            resultPanel.style.animation = 'none';
            setTimeout(() => {
                resultPanel.style.animation = 'popIn 0.5s';
            }, 10);
        }
       
        // –ó–∞–∫—Ä–∏—Ç—Ç—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
        function closeResult() {
            document.getElementById('resultPanel').style.display = 'none';
        }
       
        // –ê–Ω—ñ–º–∞—Ü—ñ—è —Å–ª–æ—Ç—ñ–≤
        function startSlotAnimation() {
            const slots = ['slot1', 'slot2', 'slot3'];
           
            slots.forEach((slotId, index) => {
                const slot = document.getElementById(slotId);
                let counter = 0;
               
                const slotInterval = setInterval(() => {
                    const randomMask = config.masks[Math.floor(Math.random() * config.masks.length)];
                    const maskImg = document.getElementById(randomMask);
                    if (maskImg) {
                        slot.src = maskImg.src;
                    }
                    counter++;
                   
                    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –∑—É–ø–∏–Ω–∫–∏
                    slot.dataset.intervalId = slotInterval;
                }, 100 + (index * 50)); // –†—ñ–∑–Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–ª–æ—Ç–∞
            });
        }
       
        // –ó—É–ø–∏–Ω–∫–∞ –∞–Ω—ñ–º–∞—Ü—ñ—ó —Å–ª–æ—Ç—ñ–≤
        function stopSlotAnimation(finalMask) {
            const slots = ['slot1', 'slot2', 'slot3'];
           
            // –û—Ç—Ä–∏–º—É—î–º–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ñ—ñ–Ω–∞–ª—å–Ω–æ—ó –º–∞—Å–∫–∏
            const finalMaskImg = document.getElementById(finalMask);
           
            // –ó—É–ø–∏–Ω—è—î–º–æ –∫–æ–∂–µ–Ω —Å–ª–æ—Ç –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é –¥–ª—è –µ—Ñ–µ–∫—Ç—É
            slots.forEach((slotId, index) => {
                setTimeout(() => {
                    const slot = document.getElementById(slotId);
                   
                    // –ó—É–ø–∏–Ω—è—î–º–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª
                    if (slot.dataset.intervalId) {
                        clearInterval(parseInt(slot.dataset.intervalId));
                    }
                   
                    // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
                    if (finalMaskImg) {
                        slot.src = finalMaskImg.src;
                    }
                }, index * 300); // –ó–∞—Ç—Ä–∏–º–∫–∞ –º—ñ–∂ –∑—É–ø–∏–Ω–∫–æ—é —Å–ª–æ—Ç—ñ–≤
            });
        }
       
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ª–æ—Ç—ñ–≤
        function updateSlots(maskId) {
            const maskImg = document.getElementById(maskId);
            if (!maskImg) return;
           
            // –û–Ω–æ–≤–ª—é—î–º–æ –ø–µ—Ä—à–∏–π —Å–ª–æ—Ç (—ñ–Ω—à—ñ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è –≤ –∞–Ω—ñ–º–∞—Ü—ñ—ó)
            const slot1 = document.getElementById('slot1');
            slot1.src = maskImg.src;
        }
       
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        window.addEventListener('DOMContentLoaded', () => {
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤—É –º–∞—Å–∫—É
            setMask('mask1');
           
            // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ —Å–ª–æ—Ç–∏
            const maskImg = document.getElementById('mask1');
            const slots = ['slot1', 'slot2', 'slot3'];
            slots.forEach(slotId => {
                const slot = document.getElementById(slotId);
                slot.src = maskImg.src;
            });
           
            // –û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space') {
                    if (gameState.isSpinning) {
                        stopGame();
                    } else {
                        startGame();
                    }
                }
            });
           
            // –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–µ—Ä—É–≤–∞–Ω–Ω—è
            console.log('–ì—Ä–∞ –≥–æ—Ç–æ–≤–∞! –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å START –∞–±–æ –ø—Ä–æ–±—ñ–ª –¥–ª—è –ø–æ—á–∞—Ç–∫—É.');
        });
       
        // –°—Ç–∏–ª—ñ –¥–ª—è –∞–Ω—ñ–º–∞—Ü—ñ–π
        const style = document.createElement('style');
        style.textContent = `
            @keyframes popIn {
                0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
                70% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            }
           
            @keyframes pulse {
                0% { opacity: 0.3; }
                50% { opacity: 0.7; }
                100% { opacity: 0.3; }
            }
           
            #glowEffect {
                animation: pulse 1s infinite;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
